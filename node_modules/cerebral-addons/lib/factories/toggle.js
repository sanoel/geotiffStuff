'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

exports.default = function (path) {
  var onValue = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];
  var offValue = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];

  var getValue = (0, _get2.default)(path);
  var setValue = (0, _set2.default)(path);

  var toggleWrite = function toggleWrite(args, value, async) {
    var response = setValue(args, value === onValue ? offValue : onValue);
    if (response && typeof response.then === 'function') {
      response.then(args.output.success).catch(args.output.error);
    } else if (async) {
      args.output.success();
    }
  };

  var toggle = function toggleRead(args) {
    var value = getValue(args);
    if (value && typeof value.then === 'function') {
      value.then(function (val) {
        return toggleWrite(args, val, true);
      }).catch(args.output.error);
    } else {
      toggleWrite(args, value);
    }
  };

  toggle.displayName = 'addons.toggle(' + (0, _toDisplayName2.default)(path, getValue) + ')';

  return toggle;
};

var _get = require('cerebral-url-scheme-compiler/get');

var _get2 = _interopRequireDefault(_get);

var _set = require('cerebral-url-scheme-compiler/set');

var _set2 = _interopRequireDefault(_set);

var _toDisplayName = require('../helpers/toDisplayName');

var _toDisplayName2 = _interopRequireDefault(_toDisplayName);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }